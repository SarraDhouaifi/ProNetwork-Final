<div class="card post-card" id="post-<%= post._id %>">
    <div class="post-header">
        <a href="/user/<%= post.author._id %>" style="text-decoration:none;">
            <div class="avatar-sm">
                <% if(post.author.profilePicture) { %>
                    <img src="<%= post.author.profilePicture %>" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">
                <% } else { %>
                    <%= post.author.firstName.charAt(0) %>
                <% } %>
            </div>
        </a>
        <div class="post-info">
            <a href="/user/<%= post.author._id %>" style="text-decoration:none; color:inherit;">
                <h4><%= post.author.firstName %> <%= post.author.lastName %></h4>
            </a>
            <p><%= post.author.headline || 'Member' %></p>
            <span class="time" data-time="<%= post.createdAt %>">Just now</span>
        </div>
        
        <% if (user._id.toString() === post.author._id.toString()) { %>
            <div style="margin-left: auto;">
                <button onclick="deletePost('<%= post._id %>')" style="color: #666; border: none; background: none; cursor: pointer;">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>
        <% } %>
    </div>
    
    <div class="post-body">
        <p style="margin-bottom: 10px;"><%= post.text %></p>
        <% if(post.image) { %>
            <img src="<%= post.image %>" style="width: 100%; border-radius: 8px; margin-top: 10px;">
        <% } %>
    </div>
    
    <div class="post-stats">
        <span><i class="fa-solid fa-thumbs-up" style="color: #378fe9;"></i> <span id="likes-count-<%= post._id %>"><%= post.likes.length %></span></span>
        <span><span id="comments-count-<%= post._id %>"><%= post.comments.length %></span> comments â€¢ <span id="shares-count-<%= post._id %>"><%= post.shares %></span> shares</span>
    </div>
    <hr>
    
    <div class="post-actions">
        <% const isLiked = post.likes.includes(user._id); %>
        <button class="btn-action <%= isLiked ? 'liked' : '' %>" onclick="toggleLike('<%= post._id %>')">
            <i class="<%= isLiked ? 'fa-solid' : 'fa-regular' %> fa-thumbs-up"></i> Like
        </button>
        <button class="btn-action" onclick="toggleCommentSection('<%= post._id %>')">
            <i class="fa-regular fa-comment"></i> Comment
        </button>
        <button class="btn-action" onclick="sharePost('<%= post._id %>')">
            <i class="fa-solid fa-share-nodes"></i> Share
        </button>
        <button class="btn-action" onclick="openSendModal('<%= post._id %>')">
            <i class="fa-regular fa-paper-plane"></i> Send
        </button>
    </div>

    <div class="comment-section" id="comments-<%= post._id %>">
        <div class="comment-list" id="comment-list-<%= post._id %>">
            <% post.comments.forEach(comment => { %>
                <div class="message-bubble" style="background: #fff; border: 1px solid #eee; width: 100%;">
                    <strong>User:</strong> <%= comment.text %>
                </div>
            <% }) %>
        </div>
        <form onsubmit="submitComment(event, '<%= post._id %>')" class="comment-input-row">
            <input type="text" name="commentText" placeholder="Write a comment..." required>
            <label style="cursor: pointer; display: flex; align-items: center;">
                <i class="fa-regular fa-image" style="color: #666;"></i>
                <input type="file" name="commentImage" style="display: none;">
            </label>
            <button type="submit" class="btn-primary" style="width: auto; padding: 5px 10px;">Post</button>
        </form>
    </div>
</div>